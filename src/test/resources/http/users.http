@baseUrl = http://localhost:8080

# Test users and credentials
@userEmail = testuser@example.com
@userPassword = secret123
@adminEmail = admin@example.com
@adminPassword = admin123
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2OTY2NmQ0NzlmNjgxZTYyNGMyOTE0MjQiLCJpYXQiOjE3NjgzMjczMzIsImV4cCI6MTc2ODMzMDkzMn0.JGBneGN03SSGKctlREtmnpCkh1xzoKSSTwZub3ONnBQ
@userId = 69666d479f681e624c291424
### Register a new user
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "email": "{{userEmail}}",
  "password": "{{userPassword}}",
  "displayName": "Test User"
}
> {%
    var body = JSON.parse(response.body || "{}");
    client.global.set("registeredUserId", body.id || "");
%}

### Login as the new user (stores token and userId)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{userEmail}}",
  "password": "{{userPassword}}"
}
> {%
    var body = JSON.parse(response.body || "{}");
    client.global.set("token", body.token || "");
    client.global.set("userId", body.userId || "");
%}

### Verify token is accepted with /me
GET {{baseUrl}}/api/auth/me
Accept: application/json
Authorization: Bearer {{token}}


### Get the user (self)
GET {{baseUrl}}/api/users/{{userId}}
Accept: application/json
Authorization: Bearer {{token}}


### Update the user (self)
PUT {{baseUrl}}/api/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "displayName": "Updated Test User"
}


### Login as admin (stores adminToken)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{adminEmail}}",
  "password": "{{adminPassword}}"
}
> {%
    var body = JSON.parse(response.body || "{}");
    client.global.set("adminToken", body.token || "");
    client.global.set("adminId", body.userId || "");
%}

### Admin: get the user by id
GET {{baseUrl}}/api/users/{{userId}}
Accept: application/json
Authorization: Bearer {{adminToken}}


### Admin: delete the user
DELETE {{baseUrl}}/api/users/{{userId}}
Authorization: Bearer {{adminToken}}


### Verify deletion (should return 404)
GET {{baseUrl}}/api/users/{{userId}}
Accept: application/json
Authorization: Bearer {{adminToken}}

